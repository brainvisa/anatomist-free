<?xml version="1.0" encoding="iso-8859-15"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
[<!ENTITY shy '-'>
<!ENTITY agrave '&agrave;'>
<!ENTITY eacute '&eacute;'>
<!ENTITY egrave '&egrave;'>
<!ENTITY acirc '&acirc;'>
<!ENTITY auml '&auml;'>
<!ENTITY ccedil '&ccedil;'>
<!ENTITY ecirc '&ecirc;'>
<!ENTITY euml '&euml;'>
<!ENTITY icirc '&icirc;'>
<!ENTITY iuml '&iuml;'>
<!ENTITY ugrave '&ugrave;'>
<!ENTITY uuml '&ucirc;'>
<!ENTITY ucirc '&ucirc;'>
<!ENTITY ocirc '&ocirc;'>
]>
<!-- ou -->
<!--
<?xml version="1.0" encoding="iso-8859-15" ?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.1.2//EN"
"http://www.oasis-open.org/docbook/xml/4.1.2/docbookx.dtd">
-->

<book>

<bookinfo>
    <title>Anatomist and library Aims: The student book</title>
      <author>
	<firstname>DENGHIEN</firstname>
	<surname>Isabelle</surname>
      </author>
      <date>06/2004</date>
      <edition>Manuel V1</edition>
</bookinfo>


  <chapter>
    <title>For a novice student</title>
    <sect1>
      <title>Exercise 1 : Handling windows and objects</title>
      <sect2>
	<title>A T1 IRM</title>
	<para></para>
      </sect2>
      <sect2>
	<title>A T1 IRM with hemisphere meshes</title>
	<para></para>
      </sect2>
      <sect2>
	<title>A T1 IRM with cortical folds graph</title>
	<para></para>
      </sect2>
    </sect1>
   <sect1>
      <title>Exercise 2 : Read of coordinates</title>
      <para></para>
    </sect1>
   <sect1>
      <title>Exercise 3 : Modify palette of colors</title>
      <para></para>
    </sect1>
   <sect1>
      <title>Exercise 4 : Create a palette of colors</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 5 : Use referentials and load a transformation</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 6 : Use referentials and visualize two analyze images</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 7 : Make a fusion between two images</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 8 : Draw a region of interest (with or without using hierarchie)</title>
      <para>In this exercise, you are going to draw 2 regions (regionA and regionB) on T1 MRI. ROIs are structures objects, 
	the graphs. One session (the graph) contains regions (noddle). One say structured because noddles are characterized
	by attributes and the relation between them can be it too. </para>
	<para>
	<itemizedlist>
	    <listitem>
              <para>Open a volume (V1), place it into a window and click on <inlinegraphic fileref="imagesAna/fb_roi.png" scale="70"/> 
		 or F1 to access to ROI toolbox.</para>
            </listitem>
	    <listitem>
              <para>If you would like to use a hierarchie (my_hierarchy.hie), open it.</para>
            </listitem>
	    <listitem>
              <para>Create a session (G1): <emphasis>RoiManagment</emphasis> > <emphasis>Session</emphasis> > 
		<emphasis>Name</emphasis>. A session with the name of volume is created automatically.</para>
            </listitem>
	    <listitem>
              <para>Create a region (regionA): <emphasis>RoiManagment</emphasis> > <emphasis>Region</emphasis> > 
		<emphasis>Name</emphasis>. If a hierarchie is selected on left general panel of Anatomist (
		list of all objects), a list of hierarchie's names are porposed.</para>
            </listitem>
	    <listitem>
              <para>Verify V1 and G1 are selected (blue) and open a windows (axiale for instance) which
		contains V1 and G1. </para>
            </listitem>
	    <listitem>
              <para>Change the panel : <emphasis>Paint</emphasis>.</para>
            </listitem>
	    <listitem>
              <para>Set up your brush (type, size, opacity ...).</para>
            </listitem>
	    <listitem>
              <para>And now you can draw !!!!! If you can't draw, verify that you have a session with region!.</para>
            </listitem>
	    <listitem>
              <para>Save your ROI graph : return to <emphasis>RoiManagment</emphasis> panel, then <emphasis>Session</emphasis> > 
		<emphasis>Save as</emphasis>. Yo can use the name by default or you can change it.</para>
            </listitem>
	</itemizedlist>
      </para>
    </sect1>

 <sect1>
      <title>Exercise 9 : Visualize ROIs (a ROIs graphe or an other kind of graph)</title>
      <para></para>
	<para>
	<itemizedlist>
	    <listitem>
              <para>Load a ROIs graph.</para>
            </listitem>
	    <listitem>
              <para>Put it into 3D window : <inlinegraphic fileref="imagesAna/window-browser-small.png" scale="90"/></para>
            </listitem>
	    <listitem>
              <para>Open a selector (<emphasis>view / select objects</emphasis>) of this 3D window by clicking with right button.</para>
            </listitem>
	    <listitem>
              <para>To view a ROI, select a noddle.</para>
            </listitem>
	</itemizedlist>
      </para>
    </sect1>
  </chapter>

  <chapter>
    <title>For an advanced student</title>
    <sect1 id="RoiHierarchy">
      <title>Exercise 1 : To label an image (writing of hierarchy) </title>
      <para>ll</para>
      <!-- &RoiHierarchy; -->
    </sect1>    
    <sect1>
      <title>Exercise 2 : Make a manual registration</title>
      <para></para>
    </sect1>

    <sect1>
      <title>Exercise 2 : Draw ROIs</title>
      <para></para>
    </sect1>

    <sect1>
      <title>Exercise 2 : Use LevelSet module</title>
      <para>
	<!--Faire un exemple avec l'extraction d'une lésion
		Montrer le principe de frontière !
		Si exemple T1 dire qu'il y a une correction du biais
	-->
      </para>
    </sect1>

    <sect1>
      <title>Exercise 2 : Visualize ralisée</title>
      <para></para>
    </sect1>

    <sect1>
      <title>Exercise 3 : Create a framework (hierarchie)</title>
      <para>To create a hierarchie, you have 2 ways to do it : manually (edit a file) or using Anatomist.</para>
      <para>For a hierarchie, named my_nomenclature with 2 regions, the one is regionA (navy blue) andand the other is
	regionB (pink). Recall you first that a region can have 3 attributes : <emphasis>name</emphasis>, <emphasis>label</emphasis>
	 and <emphasis>color</emphasis>. And secund that the link your graphe of ROI and the hierarchy can be done by 
	2 manners : with the <emphasis>name</emphasis> attribute or with the <emphasis>label</emphasis> attribute  
	(see <emphasis>Settings</emphasis> > <emphasis>Graph parameters</emphasis> > <emphasis>Use hierarchy/colors bindings</emphasis>).</para>

    <sect2>
      <title>Possibility 1 : Edit a file my_hierarchy.hie (simple text file)</title>
      <para>
	<screen>
		# tree 1.0

		*BEGIN TREE hierarchy
		graph_syntax RoiArg

		*BEGIN TREE fold_name
		name  regionA
		label region_A
		color 3 8 99

		*END

		*BEGIN TREE fold_name
		name  regionB
		label region_B
		color 255 170 255

		*END

		*END
	</screen>
	</para>
    </sect2>

    <sect2>
      <title>Possibility 2 : with Anatomist</title>
      	<para>
	<itemizedlist>
	    <listitem>
              <para>Open a volume, place it into a window and click on <inlinegraphic fileref="imagesAna/fb_roi.png" scale="70"/> 
		 or F1 to access to ROI toolbox.</para>
            </listitem>
	    <listitem>
              <para>Create the hierarchy : <emphasis>RoiManagment</emphasis> > <emphasis>Framework</emphasis> > 
		<emphasis>Personnal</emphasis> > <emphasis>New</emphasis>, for instance my_hierarchy.hie. A new objet will appear in the object list of
		BrainVISA and it will be refresh when you add a new action.</para>
            </listitem>
	    <listitem>
              <para>Add a new region : <emphasis>RoiManagment</emphasis> > <emphasis>Framework</emphasis> > 
		<emphasis>Personnal</emphasis> > <emphasis>Define new region</emphasis>. You can add regionA with a ny color (or
		3 8 99) and regionB with a pink color (or 255 170 255).</para>
            </listitem>
	    <listitem>
              <para>You can modify name or color of regions in <emphasis>RoiManagment</emphasis> > <emphasis>Framework</emphasis> > 
		<emphasis>Personnal</emphasis> > <emphasis>Modify region name</emphasis> or <emphasis>Modify region color</emphasis>.</para>
            </listitem>
	    <listitem>
              <para>And save my_hierarchie.hie in <emphasis>RoiManagment</emphasis> > <emphasis>Framework</emphasis> > 
		<emphasis>Personnal</emphasis> > <emphasis>Save</emphasis>. The file my_hierarchy.hie is locate in your_login/.anatomist
		/frameworks. An other way to save it, click with right button on my_hierarchy object and <emphasis>Save</emphasis> 
		 for instance my_hierarchy.hie. </para>
            </listitem>
	</itemizedlist>
	</para>
	<para>Note :  To verify your hierarchie, you can put it into a browser 
	(<inlinegraphic fileref="imagesAna/window_browser.png" scale="70"/>) and see this ....
	<figure>
          <title>Visualize my_hierarchy.hie
          </title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="imagesAna/roi3.png" format="PNG" scale="80"/>
            </imageobject>
          </mediaobject>
        </figure>
	</para>
	<para>Note : In the first case, yo can handle name and label attribute. Both are attributes to identify a noddle. </para>

    </sect2>

    </sect1>


    <sect1>
      <title>Exercise 3 : Handle levels grey of an image and use 'profile'</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 4 : Handle levels grey of an image and use 'levelset'</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 5 : Generate a texture</title>
      <para></para>
    </sect1>
    <sect1 id="studentB_2_5">
      <title>Exercise 6 : Fusion between contrast map of activation and a mesh of cortical surface </title>
      <para>This exercice requieres to obtain 2 things :
	<itemizedlist>
	    <listitem>
              <para><emphasis>mesh of cortical surface</emphasis> : obtained with <emphasis>Anatomic Pipeline</emphasis> of BrainVISA. This file
		are named subject_Lwhite.mesh and subject_Rwhite.mesh.</para>
            </listitem>
	    <listitem>
              <para><emphasis>contrast map of activation</emphasis> : obtained by saving activation in SPM. Here we will name map.img .</para>
            </listitem>
	</itemizedlist>
      </para>
      <para>Note 1 : a particular point is how are referentiels manage. If you worked on normalised images (anatomy T1 and fMRI), all images must be in
	the same referentiel and it isn't necessary to charge the <emphasis>translation to origin SPM</emphasis>. Otherwhise, 
	if you worked on no-normalised T1 (anatomy T1 and fMRI), you must use the <emphasis>translation to origin SPM</emphasis>
	for each images. Thus, the voxel (0, 0, 0) will be at the same site for all images and your fusion will be correct. </para>
      <para>Note 2 : How do I set a referentiel to mesh ? In fact, if you used to look attributes into browser for images (in 
	particular <emphasis>spm_origin</emphasis>) , you will be disappointed because you can't read attributs for this object. 
	But this mesh is into the same referentiel of anatomy T1, in other words that means you must charge the correct referentiel
	for anatomy T1 (by using  the <emphasis>translation to origin SPM</emphasis>, for instance you obtain yellow referentiel)
	and then place your mesh object in the same referentiel (you change color of referentiel to yellow in this case)
	</para>
      <para>Now the steps are :
	<itemizedlist>
	    <listitem>
              <para>Fusion mesh of cortical surface with contrast map of activation</para>
            </listitem>
	    <listitem>
              <para>Set parameters of fusion (linear or geometric ....)</para>
            </listitem>
	    <listitem>
              <para>Take a snapshot, if you want : <emphasis>Window</emphasis> of menu of your window which contains the fusion and 
		<emphasis>save</emphasis>.</para>
            </listitem>
	</itemizedlist>
	You can do it for the other hemisphere and add this into the same window. You can add too the head mesh and modify transparence
	on it to have this kind of exemple :	METTRE UNE IMAGE
	</para>	
    </sect1>
    <sect1>
      <title>Exercise 7 : Copy a set of same attribut of graph into an other graph with the same structure</title>
      <para>This case is frequent when you have a autolabelled graph of sulci. The labels are given with <emphasis>label</emphasis>
	attribute and you would like copy value <emphasis>label</emphasis>attribute to value <emphasis>name</emphasis>attribute
	You have 2 possibilities to do it : manually or automatic.</para>
	<itemizedlist>
	    <listitem>
              <para>manually : it is the best method because you can verify each value of <emphasis>label</emphasis> attribute and
		corrected it if necessary. To do it, change value of  value <emphasis>name</emphasis> attribute and save 
		this object graph like a new graph (click on right graph and choose <emphasis>File</emphasis> - > <emphasis>Save</emphasis>.</para>
            </listitem>
            <listitem>
              <para>automatically : you can use a command line of library AIMS. This command is <emphasis>AimsGraphConvert</emphasis>.
		For instance, you can do this : 
		<screen>AimsGraphConvert -i subjectAuto.arg -o subjectAutoName.arg -c label -d name </screen>
		This command proposes others options, but with this application, you must know :
		<itemizedlist>
	    	<listitem>
              		<para><emphasis>option -i </emphasis> : autolabelled graph of sulci obtained with <emphasis>Automatic Recognition</emphasis>
			process of BrainVISA.</para>
               </listitem>
	    	<listitem>
              		<para><emphasis>option -o </emphasis> : name file of output. For instance, you can name it by adding name of modified attribute.
				The associate .data directory is created by default with this name. </para>
               </listitem>
	    	<listitem>
              		<para><emphasis>option -c </emphasis> : name of attribute uses like template (or for the copy)</para>
               </listitem>
	    	<listitem>
              		<para><emphasis>option -d </emphasis> : name of attribute for the destination </para>
               </listitem>
		<!-- use -b option to economize memory on computer -->
		</itemizedlist>
</para>
            </listitem>
	</itemizedlist>
    </sect1>
    <sect1>
      <title>Exercise 8 : Cut a mesh with a plan of anatomy </title>
      <para>
	<itemizedlist>
	    	<listitem>
			<para>Superimpose a mesh with a anatomy T1 into 3D window. Note that both are in the same referentiel because
			the mesh is obtained from anatomy T1.</para>
               </listitem>
	    	<listitem>
              		<para>Menu of 3D window : <emphasis>scene</emphasis> - > <emphasis>tools</emphasis> - > 
			<emphasis>clipping plane</emphasis> - > <emphasis>single plane</emphasis>. You should obtain
			a view like this : METTRE UNE IMAGE </para>
		</listitem>
	    	<listitem>
			<para>If you want that plane of cut is inversed, you can use the <emphasis>oblique view control</emphasis> to
			turn over anatomy T1 with the combinaison between <emphasis>shift button</emphasis> and <emphasis>middle button of mouse</emphasis>.
			You should obtain a view like this : METTRE UNE IMAGE
			</para>
               </listitem>
	</itemizedlist>
	</para>
    </sect1>
  </chapter>

  <chapter>
    <title>For an expert student</title>
    <sect1>
      <title>Exercise 1 : Visualize a hemisphere mesh (BrainVISA) with a map activation (SPM)</title>
      <sect2>
	<title>No-normalyzed SPM image</title>
	<para></para>
      </sect2>
      <sect2>
	<title>Normalyzed SPM image</title>
	<para></para>
      </sect2>
    </sect1>
    <sect1>
      <title>Exercise 2 : Use defaults transformation </title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 3 : Fusion a hemisphere mesh with a map activation</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 4 : Surface matching texture</title>
      <para></para>
    </sect1>
    <sect1>
      <title>Exercise 5 : Extraction  of sulcus mesh (from sulci graph) and fusion between them</title>
      <para>This exercise show you how you can extract one sulcus mesh (thus several) from a graph (here with sulci graph)
	and then fusion or rather concatenation between them. Note, this example is valid for nodes with mesh object.
	</para>
	<para>
	<itemizedlist>
	    	<listitem>
              		<para>First step is extract each mesh sulcus from sulci graph : 
			<itemizedlist>
	    		<listitem><para>Put your sulci graph into browser</para></listitem>
	    		<listitem><para>Save it by clicking (right button) on graph object and choose <emphasis>File</emphasis> - > <emphasis>Save</emphasis></para></listitem>
			<listitem><para>Give a name such as <emphasis>NameSuclcus1.mesh</emphasis></para></listitem>	
			</itemizedlist>
			</para>
               </listitem>
	    	<listitem>
              		<para>Secund step is the concatenation of all saved meshes : 
			<itemizedlist>
	    		<listitem><para>For this, use AimsZcat command line
				<screen>AimsZCat -i NameSuclcus1.mesh NameSuclcus2.mesh NameSuclcus3.mesh -o AllMesh.mesh</screen>
				This command proposes others options, but with this application, you must know :</para>
				<itemizedlist>
	    			<listitem><para><emphasis>option -i </emphasis>: list of meshes to (be ?) concatenate </para></listitem>
	    			<listitem>
              				<para><emphasis>option -o </emphasis> : name of output mesh file which contains all meshes.</para>
               			</listitem>
	    		<listitem><para> </para></listitem>
			<listitem><para></para></listitem>	
		</itemizedlist>
               </listitem>
	</itemizedlist>
			</para>
               </listitem>
	</itemizedlist>
	</para>
    </sect1>
   <sect1>
      <title>Exercise 5 : Map a contrast map of activation on sulcus</title>
      <para><itemizedlist>
	   <listitem><para>Save a sulcus mesh as in the exercice above</para></listitem>
	   <listitem><para>Open a contrast map of activation </para></listitem>
	   <listitem><para>Place the correct referentiel for each object <link linkend="studentB_2_5">(see exercice 5 in chapter 2)
		</link></para></listitem>
	   <listitem><para>Make a fusion between them</para></listitem>	
	   <listitem><para>Choose this fusion parameters for example :
		<itemizedlist>
	    		<listitem><para>Fusion mode : Linear (50 %)</para></listitem>
			<listitem><para>Method : Line to point</para></listitem>
			<listitem><para>Submethods : max</para></listitem>
			<listitem><para>Depth : 9 mm (explore 9 mm around sulcus) </para></listitem>
			<listitem><para>Step : 3 max (i.e. voxel size)</para></listitem>			
		</itemizedlist>
	   </para></listitem>
	   <listitem><para>Click on <emphasis>Apply</emphasis></para></listitem>
       </itemizedlist></para>
    </sect1>
  </chapter>


<glossary>

<glossdiv>
<title>H</title>

<glossentry>
<glossterm id="hierarchy">Hierarchy</glossterm>
<glossdef>
<para>It is text file which indicates information about graph nodes such as label, name or color. Format is .hie and you can edit it esaly. </para>
</glossdef>
</glossentry>

</glossdiv>
</glossary>




</book>
